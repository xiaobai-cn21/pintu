<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="format-detection" content="email=no">
    <meta name="format-detection" content="address=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#20223A">
    <title>æ‹¼å›¾å¤§å¸ˆ - ä¸»ç•Œé¢</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/mobile.css') }}">
</head>
<body>
{% include '_navbar.html' %}
<div class="container" style="max-width: 800px; margin: 0 auto; text-align: center;">
    <div class="background-blur"></div>
    <div class="content">
        <div class="logo" style="margin: 60px 0 60px;">
            <h1 class="main-title"><span class="english-text">Puzzle</span> <span class="english-text">Master</span></h1>

            <p class="chinese-text main-subtitle">æ‹¼å‡ºä½ çš„ä¸“å±ä¸–ç•Œ</p>
        </div>
        <div class="menu-btns" style="display: flex; flex-direction: column; gap: 16px; max-width: 300px; margin: 0 auto;">
            <button id="loginBtn" class="btn btn-primary"><span class="chinese-text">ç™»å½•</span><span class="symbol-text"> / </span><span class="chinese-text">æ³¨å†Œ</span></button>
            <a class="btn btn-default" href="{{ url_for('option_page') }}"><span class="chinese-text">å¼€å§‹æ¸¸æˆ</span></a>
            <button id="helpBtn" class="btn btn-default"><span class="chinese-text">å¸®åŠ©ä¸­å¿ƒ</span></button>
            <a id="createPuzzleBtn" class="btn btn-default" style="display: none;" href="{{ url_for('editor_page') }}"><span class="chinese-text">åˆ›å»ºæ‹¼å›¾</span></a>
            <a id="rankBtn" class="btn btn-default" style="display: none;" href="{{ url_for('rank_page') }}"><span class="chinese-text">æ’è¡Œæ¦œ</span></a>
            <a id="versusBtn" class="btn btn-default" style="display: none;" href="{{ url_for('versus_page') }}"><span class="chinese-text">æˆ¿é—´å¯¹æˆ˜</span></a>
            <a id="myPuzzleBtn" class="btn btn-default" style="display: none;" href="{{ url_for('my_puzzle_page') }}"><span class="chinese-text">æˆ‘çš„æ‹¼å›¾</span></a>
            <a id="shareBtn" class="btn btn-default" style="display: none;" href="{{ url_for('share_page') }}"><span class="chinese-text">åˆ†äº«ä¸­å¿ƒ</span></a>
            <a id="aiBtnHome" class="btn btn-default" style="display: none;" href="{{ url_for('ai_page') }}"><span class="english-text">AI</span> <span class="chinese-text">ç”Ÿæˆ</span></a>
        </div>
        <div class="copyright" style="position: fixed; bottom: 20px; left: 0; width: 100%; text-align: center; font-size: 12px; color: #999999;">
            Â© 2025 æ‹¼å›¾å¤§å¸ˆ ç‰ˆæƒæ‰€æœ‰
        </div>
    </div>

    <div class="modal-mask" id="loginModal">
        <div class="modal-content">
            <div class="modal-header">
                <span id="modalTitle">ç™»å½•</span>
                <span class="modal-close" onclick="document.getElementById('loginModal').style.display='none'">Ã—</span>
            </div>
            <div class="modal-body">
                <div class="tab-switch" style="display: flex; margin-bottom: 16px; border: 2px solid #F9E078; border-radius: 0;">
                    <span class="tab-item active" style="flex: 1; text-align: center; padding: 8px; cursor: pointer; background: #F9E078; color: #20223A; font-weight: bold;" onclick="switchTab('login')">ç™»å½•</span>
                    <span class="tab-item" style="flex: 1; text-align: center; padding: 8px; cursor: pointer; color: #B8BCC8; background: transparent;" onclick="switchTab('register')">æ³¨å†Œ</span>
                </div>
                <form id="loginForm">
                    <div class="input-item">
                        <label>ç”¨æˆ·å<span class="symbol-text"> / </span>é‚®ç®±</label>
                        <input type="text" id="loginAccount" placeholder="è¯·è¾“å…¥ç”¨æˆ·åæˆ–é‚®ç®±">
                        <div class="error-tip" id="loginAccountError">è¯·è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åæˆ–é‚®ç®±</div>
                    </div>
                    <div class="input-item">
                        <label>å¯†ç </label>
                        <input type="password" id="loginPwd" placeholder="è¯·è¾“å…¥å¯†ç ">
                        <div class="error-tip" id="loginPwdError">å¯†ç é”™è¯¯</div>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <label style="display: flex; align-items: center; gap: 6px; font-size: 14px; color: #B8BCC8;">
                            <input type="checkbox" id="rememberMe" style="width: 16px; height: 16px; margin: 0;"> è®°ä½æˆ‘<span class="symbol-text">ï¼ˆ</span><span class="number-text">30</span>å¤©<span class="symbol-text">ï¼‰</span>
                        </label>
                        <span style="font-size: 14px; color: #B8BCC8; cursor: pointer;">å¿˜è®°å¯†ç ï¼Ÿ</span>
                    </div>
                </form>
                <form id="registerForm" style="display: none;">
                    <div class="input-item">
                        <label>ç”¨æˆ·å<span class="symbol-text">ï¼ˆ</span><span class="number-text">4</span><span class="symbol-text">-</span><span class="number-text">16</span>ä½ï¼Œå«å­—æ¯<span class="symbol-text">/</span>æ•°å­—<span class="symbol-text">/</span>ä¸‹åˆ’çº¿<span class="symbol-text">ï¼‰</span></label>
                        <input type="text" id="regUsername" placeholder="è¯·è¾“å…¥ç”¨æˆ·å">
                        <div class="error-tip" id="regUsernameError">ç”¨æˆ·åæ ¼å¼é”™è¯¯æˆ–å·²å­˜åœ¨</div>
                    </div>
                    <div class="input-item">
                        <label>é‚®ç®±</label>
                        <input type="email" id="regEmail" placeholder="è¯·è¾“å…¥é‚®ç®±">
                        <div class="error-tip" id="regEmailError">é‚®ç®±æ ¼å¼é”™è¯¯æˆ–å·²å­˜åœ¨</div>
                    </div>
                    <div class="input-item">
                        <label>å¯†ç <span class="symbol-text">ï¼ˆ</span><span class="number-text">8</span><span class="symbol-text">-</span><span class="number-text">20</span>ä½ï¼Œå«å¤§å°å†™<span class="symbol-text">/</span>æ•°å­—<span class="symbol-text">/</span>ç‰¹æ®Šç¬¦å·<span class="symbol-text">ï¼‰</span></label>
                        <input type="password" id="regPwd" placeholder="è¯·è¾“å…¥å¯†ç ">
                        <div class="error-tip" id="regPwdError">å¯†ç æ ¼å¼ä¸ç¬¦åˆè¦æ±‚</div>
                    </div>
                    <div class="input-item">
                        <label>ç¡®è®¤å¯†ç </label>
                        <input type="password" id="regPwdConfirm" placeholder="è¯·å†æ¬¡è¾“å…¥å¯†ç ">
                        <div class="error-tip" id="regPwdConfirmError">ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´</div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-default" onclick="document.getElementById('loginModal').style.display='none'">å–æ¶ˆ</button>
                <button id="submitLogin" class="btn btn-primary">ç™»å½•</button>
                <button id="submitRegister" class="btn btn-primary" style="display: none;">æ³¨å†Œ</button>
            </div>
        </div>
    </div>

    <div class="modal-mask" id="helpModal" style="display: none;">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <span>æ“ä½œæŒ‡å—</span>
                <span class="modal-close" onclick="document.getElementById('helpModal').style.display='none'">Ã—</span>
            </div>
            <div class="modal-body" style="font-size: 14px; line-height: 24px; color: #E0E0E0;">
                <!-- æ¡Œé¢ç«¯æ“ä½œæŒ‡å— -->
                <div id="desktop-help" style="display: none;">
                    <p><strong style="color: #F9E078;">1. æ¸¸æˆæ“ä½œ</strong></p>
                    <p>- é¼ æ ‡å·¦é”®é•¿æŒ‰å›¾å—ï¼Œæ‹–æ‹½åˆ°æ‹¼å›¾åŒºåŸŸ</p>
                    <p>- å•å‡»é€‰ä¸­çš„å›¾å—ï¼Œé¡ºæ—¶é’ˆæ—‹è½¬90åº¦</p>
                    <p>- ç‚¹å‡»"æ’¤é”€"å¯è¿˜åŸä¸Šä¸€æ­¥æ“ä½œï¼Œ"é‡åš"æ¢å¤æ’¤é”€æ“ä½œ</p>
                    <p><strong style="color: #F9E078; margin-top: 16px; display: block;">2. è‡ªå®šä¹‰æ‹¼å›¾</strong></p>
                    <p>- æ”¯æŒä¸Šä¼ æœ¬åœ°å›¾ç‰‡ï¼ˆJPG/PNGï¼Œæœ€å¤§5MBï¼‰ï¼Œå¯è£å‰ªè°ƒæ•´</p>
                    <p>- å¯è®¾ç½®æ‹¼å›¾å—æ•°ï¼ˆ4-64å—ï¼‰ã€å½¢çŠ¶ï¼ˆçŸ©å½¢/å¼‚å½¢ï¼‰ã€æ˜¯å¦æ—‹è½¬</p>
                    <p><strong style="color: #F9E078; margin-top: 16px; display: block;">3. å­˜æ¡£ä¸åˆ†äº«</strong></p>
                    <p>- ç™»å½•ç”¨æˆ·å­˜æ¡£åŒæ­¥è‡³æœåŠ¡å™¨ï¼Œæ¸¸å®¢å­˜æ¡£ä»…ä¿å­˜åœ¨å½“å‰æµè§ˆå™¨</p>
                    <p>- è‡ªå®šä¹‰æ‹¼å›¾å¯åˆ†äº«è‡³"åˆ†äº«ä¸­å¿ƒ"ï¼Œä¾›å…¶ä»–ç©å®¶æ¸¸ç©</p>
                </div>
                
                <!-- ç§»åŠ¨ç«¯æ“ä½œæŒ‡å— -->
                <div id="mobile-help" style="display: none;">
                    <p><strong style="color: #F9E078;">ğŸ“± ç§»åŠ¨ç«¯æ“ä½œæŒ‡å—</strong></p>
                    <p><strong style="color: #F9E078;">1. æ‹¼å›¾å—æ“ä½œ</strong></p>
                    <p>- <strong>é•¿æŒ‰æ‹–æ‹½</strong>ï¼šé•¿æŒ‰æ‹¼å›¾å—å¼€å§‹æ‹–æ‹½åˆ°æ£‹ç›˜</p>
                    <p>- <strong>å•å‡»é€‰ä¸­</strong>ï¼šå•å‡»æ‹¼å›¾å—æ˜¾ç¤ºé€‰ä¸­æ•ˆæœ</p>
                    <p>- <strong>åŒå‡»æ—‹è½¬</strong>ï¼šåŒå‡»æ‹¼å›¾å—é¡ºæ—¶é’ˆæ—‹è½¬90åº¦</p>
                    <p>- <strong>ä¸‰å‡»ç¿»è½¬</strong>ï¼šä¸‰å‡»æ‹¼å›¾å—æ°´å¹³ç¿»è½¬</p>
                    <p><strong style="color: #F9E078; margin-top: 16px; display: block;">2. æ‹¼å›¾å—æ </strong></p>
                    <p>- æ‰€æœ‰æ‹¼å›¾å—ä»¥å¤šè¡Œå½¢å¼æ˜¾ç¤ºï¼Œæ— éœ€æ»šåŠ¨</p>
                    <p>- æ‹¼å›¾å—è‡ªåŠ¨å±…ä¸­å¯¹é½ï¼Œé—´è·é€‚ä¸­</p>
                    <p><strong style="color: #F9E078; margin-top: 16px; display: block;">3. æ¸¸æˆæ§åˆ¶</strong></p>
                    <p>- ç‚¹å‡»"æ’¤é”€"å¯è¿˜åŸä¸Šä¸€æ­¥æ“ä½œ</p>
                    <p>- ç‚¹å‡»"ä¿å­˜è¿›åº¦"ä¿å­˜å½“å‰æ¸¸æˆçŠ¶æ€</p>
                    <p>- ç‚¹å‡»"æ¢å¤è¿›åº¦"æ¢å¤ä¹‹å‰ä¿å­˜çš„æ¸¸æˆ</p>
                    <p><strong style="color: #F9E078; margin-top: 16px; display: block;">4. å…¶ä»–åŠŸèƒ½</strong></p>
                    <p>- æ”¯æŒä¸Šä¼ æœ¬åœ°å›¾ç‰‡åˆ›å»ºè‡ªå®šä¹‰æ‹¼å›¾</p>
                    <p>- å¯è®¾ç½®æ‹¼å›¾å—æ•°ï¼ˆ4-64å—ï¼‰ã€å½¢çŠ¶ã€æ˜¯å¦æ—‹è½¬</p>
                    <p>- ç™»å½•ç”¨æˆ·å­˜æ¡£åŒæ­¥è‡³æœåŠ¡å™¨</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="document.getElementById('helpModal').style.display='none'">æˆ‘çŸ¥é“äº†</button>
            </div>
        </div>
    </div>
</div>

<script>
function switchTab(type){
    const loginForm=document.getElementById('loginForm');
    const registerForm=document.getElementById('registerForm');
    const loginBtnEl=document.getElementById('submitLogin');
    const registerBtnEl=document.getElementById('submitRegister');
    const modalTitle=document.getElementById('modalTitle');
    const tabItems=document.querySelectorAll('.tab-item');
    if(type==='login'){
        loginForm.style.display='block';
        registerForm.style.display='none';
        loginBtnEl.style.display='block';
        registerBtnEl.style.display='none';
        modalTitle.textContent='ç™»å½•';
        tabItems[0].classList.add('active');
        tabItems[0].style.background='#F9E078';
        tabItems[0].style.color='#20223A';
        tabItems[0].style.fontWeight='bold';
        tabItems[1].classList.remove('active');
        tabItems[1].style.background='transparent';
        tabItems[1].style.color='#B8BCC8';
        tabItems[1].style.fontWeight='normal';
    }else{
        loginForm.style.display='none';
        registerForm.style.display='block';
        loginBtnEl.style.display='none';
        registerBtnEl.style.display='block';
        modalTitle.textContent='æ³¨å†Œ';
        tabItems[1].classList.add('active');
        tabItems[1].style.background='#F9E078';
        tabItems[1].style.color='#20223A';
        tabItems[1].style.fontWeight='bold';
        tabItems[0].classList.remove('active');
        tabItems[0].style.background='transparent';
        tabItems[0].style.color='#B8BCC8';
        tabItems[0].style.fontWeight='normal';
    }
}
document.getElementById('loginBtn').addEventListener('click',()=>{document.getElementById('loginModal').style.display='flex'});
// ç§»åŠ¨ç«¯è®¾å¤‡æ£€æµ‹å’Œç±»æ·»åŠ 
(function() {
    'use strict';
    
    function isMobile() {
        return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ||
               window.innerWidth <= 768;
    }
    
    function addMobileClass() {
        if (isMobile()) {
            document.body.classList.add('mobile-device');
        }
    }
    
    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', addMobileClass);
    } else {
        addMobileClass();
    }
    
    // çª—å£å¤§å°æ”¹å˜æ—¶é‡æ–°æ£€æµ‹
    window.addEventListener('resize', function() {
        setTimeout(addMobileClass, 100);
    });
})();

document.getElementById('helpBtn').addEventListener('click',()=>{
    const helpModal = document.getElementById('helpModal');
    if (helpModal) {
        helpModal.style.display = 'flex';
        
        // æ ¹æ®è®¾å¤‡ç±»å‹æ˜¾ç¤ºç›¸åº”çš„å¸®åŠ©å†…å®¹
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth <= 768;
        const desktopHelp = document.getElementById('desktop-help');
        const mobileHelp = document.getElementById('mobile-help');
        
        if (isMobile) {
            desktopHelp.style.display = 'none';
            mobileHelp.style.display = 'block';
        } else {
            desktopHelp.style.display = 'block';
            mobileHelp.style.display = 'none';
        }
    }
});
window.onload=function(){
  const token=localStorage.getItem('puzzleToken');
  if(token){
    document.getElementById('loginBtn').style.display='none';
    document.getElementById('createPuzzleBtn').style.display='block';
    document.getElementById('rankBtn').style.display='block';
    document.getElementById('versusBtn').style.display='block';
    document.getElementById('myPuzzleBtn').style.display='block';
    document.getElementById('shareBtn').style.display='block';
    const aiBtn=document.getElementById('aiBtnHome'); if(aiBtn) aiBtn.style.display='block';
  }
}
// æµ‹è¯•ç™»å½•ä»£ç å·²ç§»é™¤ï¼Œä½¿ç”¨çœŸå®ç™»å½•
</script>
<script>
// çœŸå®ç™»å½•
async function realLogin(){
  const loginKey=document.getElementById('loginAccount').value.trim();
  const password=document.getElementById('loginPwd').value.trim();
  const res=await fetch('/auth/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({loginKey,password})});
  const json=await res.json();
  if(json.code===200&&json.data){
    localStorage.setItem('puzzleToken', json.data.token);
    localStorage.setItem('userId', json.data.userId);
    window.location.reload();
  }else{ alert(json.message||'ç™»å½•å¤±è´¥'); }
}
document.getElementById('submitLogin').onclick=realLogin;

// çœŸå®æ³¨å†Œ
async function realRegister(){
  const username=document.getElementById('regUsername').value.trim();
  const email=document.getElementById('regEmail').value.trim();
  const password=document.getElementById('regPwd').value.trim();
  const confirmPassword=document.getElementById('regPwdConfirm').value.trim();
  const res=await fetch('/auth/signin',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username,email,password,confirmPassword})});
  const json=await res.json();
  if(json.code==200){ alert('æ³¨å†ŒæˆåŠŸï¼Œè¯·ç™»å½•'); switchTab('login'); }
  else{ alert(json.message||'æ³¨å†Œå¤±è´¥'); }
}
document.getElementById('submitRegister').onclick=realRegister;
</script>
    <!-- é¡µé¢ç‰¹å®šçš„èƒŒæ™¯éŸ³ä¹ -->
    <script>
        // ç­‰å¾…éŸ³ä¹ç®¡ç†å™¨åŠ è½½å®Œæˆ
        function initPageMusic() {
            if (window.musicManager) {
                // ä¸»ç•Œé¢è‡ªåŠ¨æ’­æ”¾ä¸»ç•Œé¢éŸ³ä¹
                window.musicManager.playScene('main');
            } else {
                // å¦‚æœéŸ³ä¹ç®¡ç†å™¨å°šæœªåŠ è½½ï¼Œç¨åé‡è¯•
                setTimeout(initPageMusic, 100);
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåç›´æ¥åˆå§‹åŒ–éŸ³ä¹ï¼Œæ— éœ€ç­‰å¾…ç”¨æˆ·äº¤äº’
        document.addEventListener('DOMContentLoaded', function() {
            // ç›´æ¥å°è¯•æ’­æ”¾éŸ³ä¹
            initPageMusic();
        });
    </script>
</body>
</html>


